getwd()
read.csv("Xproject_Final Parameters Pivoted.csv")
PK = read.csv("Xproject_Final Parameters Pivoted.csv")
PK
head(PK)
PK$AUClast
data.frame(PK$AUClast, PK$AUCINF_obs, PK$Cmax, PK$tmax, PK$lambda_z, PK$CL_F_obs, PK$Vz_F_obs, PK$MRTlast)
colnames(PK)
data.frame(PK$AUClast, PK$AUCINF_obs)
data.frame(PK$AUClast, PK$AUCINF_obs, PK$Cmax, PK$tmax, PK$lambda_z)
PK$lambda_z
colnames(PK)
data.frame(PK$AUClast, PK$AUCINF_obs, PK$Cmax, PK$tmax, PK$Lambda_z, PK$CL_F_obs, PK$Vz_F_obs, PK$MRTlast)
data.frame(PK$AUClast, PK$AUCINF_obs, PK$Cmax, PK$tmax, PK$Lambda_z)
data.frame(PK$AUClast, PK$AUCINF_obs, PK$Cmax, PK$Tmax, PK$Lambda_z)
data.frame(PK$AUClast, PK$AUCINF_obs, PK$Cmax, PK$Tmax, PK$Lambda_z, PK$CL_F_obs, PK$Vz_F_obs, PK$MRTlast)
colnames(PK)
data.frame(PK$AUClast, PK$AUCINF_obs, PK$Cmax, PK$Tmax, PK$Lambda_z,
PK$Cl_F_obs, PK$Vz_F_obs, PK$MRTlast)
PKWhatWeNeed = data.frame(PK$AUClast, PK$AUCINF_obs, PK$Cmax, PK$Tmax, PK$Lambda_z, PK$Cl_F_obs, PK$Vz_F_obs, PK$MRTlast)
write.csv(PKWhatWeNeed, "Xproject_Final_for_Word.csv")
View("Xproject_Final_for_Word.csv")
?write.csv
PK = read.csv("Xproject_Final Parameters Pivoted.csv")
head(PK)
PKWhatWeNeed = data.frame(PK$ID, PK$AUClast, PK$AUCINF_obs, PK$Cmax, PK$Tmax, PK$Lambda_z, PK$Cl_F_obs, PK$Vz_F_obs, PK$MRTlast)
write.csv(PKWhatWeNeed, "Xproject_Final_for_Word.csv", row.names = FALSE)
PK = read.csv("Xproject_Final Parameters Pivoted.csv")
PKWhatWeNeed = data.frame(PK$ID, PK$AUClast, PK$AUCINF_obs, PK$Cmax, PK$Tmax, PK$Lambda_z, PK$Cl_F_obs, PK$Vz_F_obs, PK$MRTlast)
write.csv(PKWhatWeNeed, "Xproject_Final_for_Word.csv", row.names = FALSE)
PKWhatWeNeed
plot(PKWhatWeNeed$PK.Cmax)
boxplot(PKWhatWeNeed$PK.Cmax)
boxplot(PKWhatWeNeed$PK.Cmax, PKWhatWeNeed$PK.AUClast)
boxplot(PKWhatWeNeed$PK.Cmax[1:10], PKWhatWeNeed$PK.Cmax[11:20])
PKRaw = read.csv("Drug_X_PK.csv")
# There's missing ID so we implemented this code.
UniID = unique(PKRaw$ID)
for (i in 1:length(UniID)){
PKRaw01 = PKRaw[PKRaw$ID == UniID[i], ]
plot(PKRaw01$TIME, PKRaw01$DV, main = paste0("SUBJID ", UniID[i], sep=" ", PKRaw01$Drug[1], "mg"), ylim=c(0,200), xlab="Time (hour)", ylab="Concentration (ug/L)")
lines(PKRaw01$TIME, PKRaw01$DV, type="l")
}
library(ggplot2)
library(ggplot2)
for (i in 1:length(UniID)){
PKRaw01 = PKRaw[PKRaw$ID == UniID[i], ]
FINAL = ggplot(PKRaw01, aes(x = TIME, y = DV)) + geom_point() + geom_line() + ggtitle(paste0("SUBJID ", UniID[i], sep=" ", PKRaw01$Drug[1], "mg")) + xlab("Time (hour)") + ylab("Concentration (ug/L)") + expand_limits(y=c(0,200))
plot(FINAL)
ggsave(filename = paste0("ggplotfigs/SUBJID", UniID[i], ".png"), FINAL)
}
PK = read.csv("Xproject_Final Parameters Pivoted.csv")
PKWhatWeNeed = data.frame(PK$ID, PK$AUClast, PK$AUCINF_obs, PK$Cmax, PK$Tmax, PK$Lambda_z, PK$Cl_F_obs, PK$Vz_F_obs, PK$MRTlast)
write.csv(PKWhatWeNeed, "Xproject_Final_for_Word.csv", row.names = FALSE)
plot(PKWhatWeNeed$PK.Cmax)
View("Xproject_Final_for_Word.csv")
getwd()
# Loading
#setwd("D:/AMC")
setwd("D:/Subintern/WNL")
PKRaw = read.csv("Drug_X_PK.csv")
# There's missing ID so we implemented this code.
UniID = unique(PKRaw$ID)
# Base plot
for (i in 1:length(UniID)){
PKRaw01 = PKRaw[PKRaw$ID == UniID[i], ]
plot(PKRaw01$TIME, PKRaw01$DV, main = paste0("SUBJID ", UniID[i], sep=" ", PKRaw01$Drug[1], "mg"), ylim=c(0,200), xlab="Time (hour)", ylab="Concentration (ug/L)")
lines(PKRaw01$TIME, PKRaw01$DV, type="l")
}
# ggplot2 - saves png files in "ggplotfigs" folder.
library(ggplot2)
for (i in 1:length(UniID)){
PKRaw01 = PKRaw[PKRaw$ID == UniID[i], ]
FINAL = ggplot(PKRaw01, aes(x = TIME, y = DV)) + geom_point() + geom_line() + ggtitle(paste0("SUBJID ", UniID[i], sep=" ", PKRaw01$Drug[1], "mg")) + xlab("Time (hour)") + ylab("Concentration (ug/L)") + expand_limits(y=c(0,200))
plot(FINAL)
ggsave(filename = paste0("ggplotfigs/SUBJID", UniID[i], ".png"), FINAL)
}
PKRaw = read.csv("Drug_X_PK.csv")
UniID = unique(PKRaw$ID)
for (i in 1:length(UniID)){
PKRaw01 = PKRaw[PKRaw$ID == UniID[i], ]
plot(PKRaw01$TIME, PKRaw01$DV, main = paste0("SUBJID ", UniID[i], sep=" ", PKRaw01$Drug[1], "mg"), ylim=c(0,200), xlab="Time (hour)", ylab="Concentration (ug/L)")
lines(PKRaw01$TIME, PKRaw01$DV, type="l")
}
library(ggplot2)
library(dplyr)
install.packages("dplyr")
library(dplyr)
View(PKRaw)
unique(HT)
unique(PKRaw$HT)
length(unique(PKRaw$HT))
mean(unique(PKRaw$HT))
mean(unique(PKRaw$WT))
mean(unique(PKRaw$AGE))
mean(unique(PKRaw$HT[PKRaw$GENE == 1]))
mean(unique(PKRaw$WT[PKRaw$GENE == 1]))
mean(unique(PKRaw$WT[PKRaw$GENE == 2]))
mean(unique(PKRaw$WT[PKRaw$GENE == 3]))
colnames(PKRaw)
PKRaw %>% group_by(GENE)
PKRaw %>% group_by(GENE) %>% summarise(MEAN = mean(WT))
mean(unique(PKRaw$WT[PKRaw$GENE == 1]))
mean(unique(PKRaw$WT[PKRaw$GENE == 2]))
mean(unique(PKRaw$WT[PKRaw$GENE == 3]))
PKRaw %>% group_by(GENE) %>% summarise(MEAN.WT = mean(WT), MEAN.HT = mean(HT))
PKRaw %>% group_by(GENE) %>% summarise(MEAN.WT = mean(WT), MIN.HT = min(HT), MEAN.HT = mean(HT))
PKRaw %>%
group_by(GENE) %>%
summarise(MEAN.WT = mean(WT), MEAN.HT = mean(HT))
PKRaw %>%
group_by(GENE) %>%
summarise(AGE.WT = mean(AGE), MEAN.WT = mean(WT), MEAN.HT = mean(HT))
PKRaw %>%
group_by(ID) %>%
summarise(Cmax = max(DV))
PKRaw %>%
group_by(ID) %>%
mutate(RankDV = min_rank(DV))
PKRaw %>%
group_by(ID) %>%
mutate(RankDV = min_rank(desc(DV)))
PKRaw %>%
group_by(ID) %>%
mutate(RankDV = min_rank(desc(DV))) %>% print(n=30)
PKRaw %>%
group_by(ID) %>%
mutate(RankDV = min_rank(desc(DV))) %>%
filter(RankDV == 1)
PKRaw %>%
group_by(ID) %>%
mutate(RankDV = min_rank(desc(DV))) %>%
filter(RankDV == 1) %>%
select(ID, TIME, DV)
PKRaw %>%
group_by(ID) %>%
mutate(RankDV = min_rank(desc(DV))) %>%
filter(RankDV == 1) %>%
select(ID, Tmax = TIME, Cmax = DV)
PKRaw %>%
group_by(ID) %>%
mutate(RankDV = min_rank(desc(DV))) %>%
filter(RankDV == 1) %>%
select(ID, Tmax = TIME, Cmax = DV, GENE)
PKRaw %>%
group_by(ID) %>%
mutate(RankDV = min_rank(desc(DV))) %>%
filter(RankDV == 1) %>%
select(ID, Tmax = TIME, Cmax = DV, GENE) %>%
group_by(GENE) %>%
summarise(Cmax.Mean = mean(Cmax))
PKRaw %>%
group_by(ID) %>%
mutate(RankDV = min_rank(desc(DV))) %>%
filter(RankDV == 1) %>%
select(ID, Tmax = TIME, Cmax = DV, GENE) %>%
group_by(GENE) %>%
summarise(Tmax.Mean = mean(Tmax), Cmax.Mean = mean(Cmax))
PKRaw %>%
group_by(ID) %>%
mutate(RankDV = min_rank(desc(DV))) %>%
filter(RankDV == 1) %>%
select(ID, Tmax = TIME, Cmax = DV, GENE, DOSE) %>%
group_by(DOSE) %>%
summarise(Tmax.Mean = mean(Tmax), Cmax.Mean = mean(Cmax))
PKRaw %>%
group_by(ID) %>%
mutate(RankDV = min_rank(desc(DV))) %>%
filter(RankDV == 1) %>%
select(ID, Tmax = TIME, Cmax = DV, GENE, Drug) %>%
group_by(Drug) %>%
summarise(Tmax.Mean = mean(Tmax), Cmax.Mean = mean(Cmax))
PKRaw %>%
group_by(ID) %>%
mutate(RankDV = min_rank(desc(DV))) %>%
filter(RankDV == 1) %>%
select(ID, Tmax = TIME, Cmax = DV, GENE, Drug) %>%
group_by(Drug, GENE) %>%
summarise(Tmax.Mean = mean(Tmax), Cmax.Mean = mean(Cmax))
group_by(ID) %>%
mutate(RankDV = min_rank(desc(DV))) %>%
filter(RankDV == 1) %>%
select(ID, Tmax = TIME, Cmax = DV, GENE, Drug) %>%
group_by(Drug, GENE) %>%
summarise(Tmax.Mean = mean(Tmax), Cmax.Mean = mean(Cmax), Cmax.Mean.Rank = min_rank(Cmax.Mean))
PKRaw %>%
group_by(ID) %>%
mutate(RankDV = min_rank(desc(DV))) %>%
filter(RankDV == 1) %>%
select(ID, Tmax = TIME, Cmax = DV, GENE, Drug) %>%
group_by(Drug, GENE) %>%
summarise(Tmax.Mean = mean(Tmax), Cmax.Mean = mean(Cmax), Cmax.Mean.Rank = min_rank(Cmax.Mean))
PKRaw %>%
group_by(ID) %>%
mutate(RankDV = min_rank(desc(DV))) %>%
filter(RankDV == 1) %>%
select(ID, Tmax = TIME, Cmax = DV, GENE, Drug) %>%
group_by(Drug, GENE) %>%
summarise(Tmax.Mean = mean(Tmax), Cmax.Mean = mean(Cmax))
PKRaw %>%
group_by(ID) %>%
mutate(RankDV = min_rank(desc(DV))) %>%
filter(RankDV == 1) %>%
select(ID, Tmax = TIME, Cmax = DV, GENE, Drug) %>%
group_by(Drug) %>%
summarise(Tmax.Mean = mean(Tmax), Cmax.Mean = mean(Cmax))
DosePK = PKRaw %>%
group_by(ID) %>%
mutate(RankDV = min_rank(desc(DV))) %>%
filter(RankDV == 1) %>%
select(ID, Tmax = TIME, Cmax = DV, GENE, Drug) %>%
group_by(Drug) %>%
summarise(Tmax.Mean = mean(Tmax), Cmax.Mean = mean(Cmax))
# -> this result will be used to draw plot.
ggplot(data = DosePK)
colnames(DosePK)
ggplot(DosePK) +
geom_point(mapping = aes(x = Drug, y = Cmax.Mean))
ggplot(DosePK) +
geom_point(mapping = aes(x = Drug, y = Cmax.Mean)) +
geom_point(mapping = aes(x = Drug, y = Tmax.Mean))
DosePK
library(tidyr)
install.packages("tidyr")
colnames(DosePK)
library(tidyr)
DosePK %>% gather(PARAMETER, VALUE, Tmax.Mean:Cmax.Mean)
ggplot(DosePK) +
geom_point(mapping = aes(x = Drug, y = VALUE, group=PARAMETER))
ggplot(TidyDosePK) +
geom_point(mapping = aes(x = Drug, y = VALUE, group=PARAMETER))
TidyDosePK = DosePK %>% gather(PARAMETER, VALUE, Tmax.Mean:Cmax.Mean)
ggplot(TidyDosePK) +
geom_point(mapping = aes(x = Drug, y = VALUE, group=PARAMETER))
ggplot(TidyDosePK) +
geom_point(mapping = aes(x = Drug, y = VALUE, color = PARAMETER))
?gather
PK = read.csv("Xproject_Final Parameters Pivoted.csv") # WNL
View(PK)
dim(PK)
dim(PK)[2]
gather(PK, Key = WNLPARAMTER, Value = WNLVALUE, 2:dim(PK)[2])
PK = read.csv("Xproject_Final Parameters Pivoted.csv") # WNL
gather(PK, Key = WNLPARAMTER, Value = WNLVALUE, 2:dim(PK)[2])
gather(PK, WNLPARAMTER, WNLVALUE, 2:dim(PK)[2])
ggplot(TidyPK) +
geom_point(mapping = aes(x = ID, y = VALUE, color = PARAMETER))
TidyPK = gather(PK, WNLPARAMTER, WNLVALUE, 2:dim(PK)[2])
ggplot(TidyPK) +
geom_point(mapping = aes(x = ID, y = VALUE, color = PARAMETER))
ggplot(TidyPK) +
geom_point(mapping = aes(x = ID, y = WNLVALUE, color = WNLPARAMTER))
ggplot(TidyPK) +
geom_point(mapping = aes(x = ID, y = WNLVALUE, color = WNLPARAMTER)) +
geom_line(mapping = aes(x = ID, y = WNLVALUE, color = WNLPARAMTER))
ggplot(TidyDosePK) +
geom_point(mapping = aes(x = Drug, y = VALUE, color = PARAMETER)) +
geom_line(mapping = aes(x = Drug, y = VALUE, color = PARAMETER))
kable(DosePK)
library(knitr)
kable(DosePK)
